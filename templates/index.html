
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Image-to-Text Converter</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css">
  <style>
    /* Dark theme CSS */
    body {
      background-color: #121212;
      color: #e6e6e6;
    }
    .light-mode {
      display: none;
    }
    .drop-area {
      border: 2px dashed #e6e6e6;
      border-radius: 8px;
      width: 100%;
      max-width: 800px;
      height: 300px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin-bottom: 16px;
    }
    .drop-area.dragover {
      background-color: #2b2b2b;
      border-color: #fff;
    }
    .drop-area.dragover .drop-message {
      color: #fff;
    }
  </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen">
  <div class="w-full max-w-md">
    <h1 class="text-4xl font-bold mb-6">Describe Text from Image</h1>
    <p class="mb-6">Easily extract text from your images with our advanced OCR technology.</p>
    <div id="image-container" class="mb-6"></div>
    <div id="text-container" class="mb-6"></div>
  </div>
  <div class="light-mode flex justify-center items-center space-x-4">
    <button id="light-mode-toggle" class="bg-white hover:bg-gray-100 text-gray-800 font-bold py-2 px-4 rounded-lg">Light Mode</button>
  </div>
  <div class="drop-area" id="image-upload-area">
    <p class="drop-message">Drag and drop an image here, or click to browse.</p>
  </div>

  <!-- Progress bar -->
  <div id="progress-bar" class="hidden w-full h-4 bg-blue-400"></div>

  <script>
    const imageUploadArea = document.getElementById('image-upload-area');
    const imageContainer = document.getElementById('image-container');
    const textContainer = document.getElementById('text-container');
  
    // Event listener for drag and drop or image upload
    imageUploadArea.addEventListener('dragover', (event) => {
      event.preventDefault();
      imageUploadArea.classList.add('dragover');
    });
    imageUploadArea.addEventListener('dragleave', () => {
      imageUploadArea.classList.remove('dragover');
    });
    imageUploadArea.addEventListener('drop', (event) => {
      event.preventDefault();
      imageUploadArea.classList.remove('dragover');
      const imageFile = event.dataTransfer.files[0];
      const formData = new FormData();
      formData.append('image', imageFile);

      // Show progress bar
      const progressBar = document.getElementById('progress-bar');
      progressBar.classList.remove('hidden');
  
      // Call the Flask backend using fetch API
      fetch('/process-image', {
        method: 'POST',
        body: formData,
        // Report upload progress
        onUploadProgress: function(progressEvent) {
          const progress = Math.round((progressEvent.loaded / progressEvent.total) * 100);
          progressBar.style.width = progress + '%';
        }
      })
      .then(response => response.json())
      .then(data => {
        // Hide progress bar
        progressBar.classList.add('hidden');
        // Display text output
        textContainer.innerHTML = `<p class="text-white">${data.caption}</p>`;
      })
      .catch(error => {
        console.error('Error:', error);
        // Hide progress bar on error
        progressBar.classList.add('hidden');
      });

      // Display uploaded image
      const reader = new FileReader();
      reader.onload = function(event) {
        const img = new Image();
        img.src = event.target.result;
        img.alt = 'Uploaded Image';
        imageContainer.innerHTML = '';
        imageContainer.appendChild(img);
      };
      reader.readAsDataURL(imageFile);
    });
  
    // Hide browse button and filename display
    const inputElement = document.createElement('input');
    inputElement.type = 'file';
    inputElement.id = 'image-upload';
    inputElement.accept = 'image/*';
    inputElement.style.display = 'none'; // Hide the input element
    inputElement.addEventListener('change', (event) => {
      const imageFile = event.target.files[0];
      const formData = new FormData();
      formData.append('image', imageFile);

      // Show progress bar
      const progressBar = document.getElementById('progress-bar');
      progressBar.classList.remove('hidden');
  
      // Call the Flask backend using fetch API
      fetch('/process-image', {
        method: 'POST',
        body: formData,
        // Report upload progress
        onUploadProgress: function(progressEvent) {
          const progress = Math.round((progressEvent.loaded / progressEvent.total) * 100);
          progressBar.style.width = progress + '%';
        }
      })
      .then(response => response.json())
      .then(data => {
        // Hide progress bar
        progressBar.classList.add('hidden');
        // Display text output
        textContainer.innerHTML = `<p class="text-white">${data.caption}</p>`;
      })
      .catch(error => {
        console.error('Error:', error);
        // Hide progress bar on error
        progressBar.classList.add('hidden');
      });

      // Display uploaded image
      const reader = new FileReader();
      reader.onload = function(event) {
        const img = new Image();
        img.src = event.target.result;
        img.alt = 'Uploaded Image';
        imageContainer.innerHTML = '';
        imageContainer.appendChild(img);
      };
      reader.readAsDataURL(imageFile);
    });
    imageUploadArea.appendChild(inputElement);
  
    // Event listener for click event on the drop area
    imageUploadArea.addEventListener('click', () => {
      inputElement.click();
    });
  
    // Light mode toggle button event listener
    const lightModeToggle = document.getElementById('light-mode-toggle');
    lightModeToggle.addEventListener('click', () => {
      const body = document.body;
      const darkThemeClass = 'dark-theme';
      const lightModeClass = 'light-mode';
      if (body.classList.contains(darkThemeClass)) {
        body.classList.remove(darkThemeClass);
        body.classList.add(lightModeClass);
        lightModeToggle.textContent = 'Dark Mode';
      } else {
        body.classList.remove(lightModeClass);
        body.classList.add(darkThemeClass);
        lightModeToggle.textContent = 'Light Mode';
      }
    });
  </script>
</body>
</html>

